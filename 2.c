#include <stdio.h>
unsigned char operation_code[255];
#define runblock {
#define endblock }
void addr_generator()
{
    FILE *f = fopen("template.txt", "w");
    fprintf(f, "void *address[] =\n");
    fprintf(f, "{\n");
    for (unsigned char i = 0; i < 15; i++)
    {
        fprintf(f, "    ");
        for (unsigned char j = 0; j < 15; j++)
        {
            fprintf(f, "&&_0x%02X, ", i * 16 + j);
        }
        fprintf(f, "&&_0x%02X,\n", i * 16 + 15);
        //fprintf(f, "\n");
    }
    for (unsigned char i = 15; i < 16; i++)
    {
        fprintf(f, "    ");
        for (unsigned char j = 0; j < 15; j++)
        {
            fprintf(f, "&&_0x%02X, ", i * 16 + j);
        }
        fprintf(f, "&&_0x%02X\n", i * 16 + 15);
        //fprintf(f, "\n");
    }
    fprintf(f, "};");
    fclose(f);
}
void addr_generator_2()
{
    FILE *f = fopen("template.txt", "w");
    fprintf(f, "goto *address[operation_code[i]];\n");
    for (unsigned char i = 0; i < 15; i++)
    {
        //fprintf(f, "    ");
        for (unsigned char j = 0; j < 15; j++)
        {
            fprintf(f, "_0x%02X:", i * 16 + j);
        }
        fprintf(f, "_0x%02X:\n", i * 16 + 15);
        //fprintf(f, "\n");
    }
    for (unsigned char i = 15; i < 16; i++)
    {
        //fprintf(f, "    ");
        for (unsigned char j = 0; j < 15; j++)
        {
            fprintf(f, "_0x%02X:", i * 16 + j);
        }
        fprintf(f, "_0x%02X:", i * 16 + 15);
        //fprintf(f, "\n");
    }
    fclose(f);
}
void addr_init()
{
}
int main()
{
    //addr_generator();
    //addr_generator_2();
    FILE *f;

    // Открытие файла на чтение
    if ((f = fopen("2.bfpp", "r")) == NULL) return 1;

    // Чтение всего файла целиком
    fread(operation_code, sizeof (operation_code), 1, f);

    void *address[] =
    {
        &&_0x00, &&_0x01, &&_0x02, &&_0x03, &&_0x04, &&_0x05, &&_0x06, &&_0x07, &&_0x08, &&_0x09, &&_0x0A, &&_0x0B, &&_0x0C, &&_0x0D, &&_0x0E, &&_0x0F,
        &&_0x10, &&_0x11, &&_0x12, &&_0x13, &&_0x14, &&_0x15, &&_0x16, &&_0x17, &&_0x18, &&_0x19, &&_0x1A, &&_0x1B, &&_0x1C, &&_0x1D, &&_0x1E, &&_0x1F,
        &&_0x20, &&_0x21, &&_0x22, &&_0x23, &&_0x24, &&_0x25, &&_0x26, &&_0x27, &&_0x28, &&_0x29, &&_0x2A, &&_0x2B, &&_0x2C, &&_0x2D, &&_0x2E, &&_0x2F,
        &&_0x30, &&_0x31, &&_0x32, &&_0x33, &&_0x34, &&_0x35, &&_0x36, &&_0x37, &&_0x38, &&_0x39, &&_0x3A, &&_0x3B, &&_0x3C, &&_0x3D, &&_0x3E, &&_0x3F,
        &&_0x40, &&_0x41, &&_0x42, &&_0x43, &&_0x44, &&_0x45, &&_0x46, &&_0x47, &&_0x48, &&_0x49, &&_0x4A, &&_0x4B, &&_0x4C, &&_0x4D, &&_0x4E, &&_0x4F,
        &&_0x50, &&_0x51, &&_0x52, &&_0x53, &&_0x54, &&_0x55, &&_0x56, &&_0x57, &&_0x58, &&_0x59, &&_0x5A, &&_0x5B, &&_0x5C, &&_0x5D, &&_0x5E, &&_0x5F,
        &&_0x60, &&_0x61, &&_0x62, &&_0x63, &&_0x64, &&_0x65, &&_0x66, &&_0x67, &&_0x68, &&_0x69, &&_0x6A, &&_0x6B, &&_0x6C, &&_0x6D, &&_0x6E, &&_0x6F,
        &&_0x70, &&_0x71, &&_0x72, &&_0x73, &&_0x74, &&_0x75, &&_0x76, &&_0x77, &&_0x78, &&_0x79, &&_0x7A, &&_0x7B, &&_0x7C, &&_0x7D, &&_0x7E, &&_0x7F,
        &&_0x80, &&_0x81, &&_0x82, &&_0x83, &&_0x84, &&_0x85, &&_0x86, &&_0x87, &&_0x88, &&_0x89, &&_0x8A, &&_0x8B, &&_0x8C, &&_0x8D, &&_0x8E, &&_0x8F,
        &&_0x90, &&_0x91, &&_0x92, &&_0x93, &&_0x94, &&_0x95, &&_0x96, &&_0x97, &&_0x98, &&_0x99, &&_0x9A, &&_0x9B, &&_0x9C, &&_0x9D, &&_0x9E, &&_0x9F,
        &&_0xA0, &&_0xA1, &&_0xA2, &&_0xA3, &&_0xA4, &&_0xA5, &&_0xA6, &&_0xA7, &&_0xA8, &&_0xA9, &&_0xAA, &&_0xAB, &&_0xAC, &&_0xAD, &&_0xAE, &&_0xAF,
        &&_0xB0, &&_0xB1, &&_0xB2, &&_0xB3, &&_0xB4, &&_0xB5, &&_0xB6, &&_0xB7, &&_0xB8, &&_0xB9, &&_0xBA, &&_0xBB, &&_0xBC, &&_0xBD, &&_0xBE, &&_0xBF,
        &&_0xC0, &&_0xC1, &&_0xC2, &&_0xC3, &&_0xC4, &&_0xC5, &&_0xC6, &&_0xC7, &&_0xC8, &&_0xC9, &&_0xCA, &&_0xCB, &&_0xCC, &&_0xCD, &&_0xCE, &&_0xCF,
        &&_0xD0, &&_0xD1, &&_0xD2, &&_0xD3, &&_0xD4, &&_0xD5, &&_0xD6, &&_0xD7, &&_0xD8, &&_0xD9, &&_0xDA, &&_0xDB, &&_0xDC, &&_0xDD, &&_0xDE, &&_0xDF,
        &&_0xE0, &&_0xE1, &&_0xE2, &&_0xE3, &&_0xE4, &&_0xE5, &&_0xE6, &&_0xE7, &&_0xE8, &&_0xE9, &&_0xEA, &&_0xEB, &&_0xEC, &&_0xED, &&_0xEE, &&_0xEF,
        &&_0xF0, &&_0xF1, &&_0xF2, &&_0xF3, &&_0xF4, &&_0xF5, &&_0xF6, &&_0xF7, &&_0xF8, &&_0xF9, &&_0xFA, &&_0xFB, &&_0xFC, &&_0xFD, &&_0xFE, &&_0xFF
    };
    unsigned char i = 0xFF;
    // Обработчик команд (диспетчеризация)
    _0x__:
    goto *address[operation_code[++i]];
    //-==========-[RUN_BLOCK]-==========-//
    _0x00: // STOP
     return 0;
    _0x01:_0x02:_0x03:_0x04:_0x05:_0x06:_0x07:_0x08:_0x09:_0x0A:_0x0B:_0x0C:_0x0D:_0x0E:_0x0F:
    _0x10:_0x11:_0x12:_0x13:_0x14:_0x15:_0x16:_0x17:_0x18:_0x19:_0x1A:_0x1B:_0x1C:_0x1D:_0x1E:_0x1F:
    _0x20:_0x21:_0x22:_0x23:_0x24:_0x25:_0x26:_0x27:_0x28:_0x29:_0x2A:_0x2B:_0x2C:_0x2D:_0x2E:_0x2F:
    _0x30:_0x31:_0x32:_0x33:_0x34:_0x35:_0x36:_0x37:_0x38:_0x39:_0x3A:_0x3B:_0x3C:_0x3D:_0x3E:_0x3F:
    _0x40:_0x41:_0x42:_0x43:_0x44:_0x45:_0x46:_0x47:_0x48:_0x49:_0x4A:_0x4B:_0x4C:_0x4D:_0x4E:_0x4F:
    _0x50:_0x51:_0x52:_0x53:_0x54:_0x55:_0x56:_0x57:_0x58:_0x59:_0x5A:_0x5B:_0x5C:_0x5D:_0x5E:_0x5F:
    _0x60:_0x61:_0x62:_0x63:_0x64:_0x65:_0x66:_0x67:_0x68:_0x69:_0x6A:_0x6B:_0x6C:_0x6D:_0x6E:_0x6F:
    _0x70:_0x71:_0x72:_0x73:_0x74:_0x75:_0x76:_0x77:_0x78:_0x79:_0x7A:_0x7B:_0x7C:_0x7D:_0x7E:_0x7F:
    _0x80:_0x81:_0x82:_0x83:_0x84:_0x85:_0x86:_0x87:_0x88:_0x89:_0x8A:_0x8B:_0x8C:_0x8D:_0x8E:_0x8F:
    _0x90:_0x91:_0x92:_0x93:_0x94:_0x95:_0x96:_0x97:_0x98:_0x99:_0x9A:_0x9B:_0x9C:_0x9D:_0x9E:_0x9F:
    _0xA0:_0xA1:_0xA2:_0xA3:_0xA4:_0xA5:_0xA6:_0xA7:_0xA8:_0xA9:_0xAA:_0xAB:_0xAC:_0xAD:_0xAE:_0xAF:
    _0xB0:_0xB1:_0xB2:_0xB3:_0xB4:_0xB5:_0xB6:_0xB7:_0xB8:_0xB9:_0xBA:_0xBB:_0xBC:_0xBD:_0xBE:_0xBF:
    _0xC0:_0xC1:_0xC2:_0xC3:_0xC4:_0xC5:_0xC6:_0xC7:_0xC8:_0xC9:_0xCA:_0xCB:_0xCC:_0xCD:_0xCE:_0xCF:
    _0xD0:_0xD1:_0xD2:_0xD3:_0xD4:_0xD5:_0xD6:_0xD7:_0xD8:_0xD9:_0xDA:_0xDB:_0xDC:_0xDD:_0xDE:_0xDF:
    _0xE0:_0xE1:_0xE2:_0xE3:_0xE4:_0xE5:_0xE6:_0xE7:_0xE8:_0xE9:_0xEA:_0xEB:_0xEC:_0xED:_0xEE:_0xEF:
    _0xF0:_0xF1:_0xF2:_0xF3:_0xF4:_0xF5:_0xF6:_0xF7:_0xF8:_0xF9:_0xFA:_0xFB:_0xFC:_0xFD:_0xFE:_0xFF:
     return 0;
    //-==========-[END_BLOCK]-==========-//
    /*
    switch (operation_code[i])
    runblock
    default:
    {
        printf("%d\n", i);
        //i++;
    }
    endblock
    goto begin;
    */
    //printf(memory);
    return 0;
}